<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>AA-Calc Weight and Balance</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">AA-Calc</h1>
      <h2 class="project-tagline">W/B calculator for Alternate Air</h2>
      <a href="http://www.alternateair.net/" class="btn">Back to Alternate Air</a>
    </section>

    <section class="main-content">
      <h3><a id="welcome-to-aa-calc" class="anchor" href="#welcome-to-aa-calc" aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to AA-Calc.</h3>
      <p>This web-based weight and balance calculator will <b>help</b> you do your "homework" before you go flying with Alternate Air aircraft.</p>

      <h3><a id="caveat-lector" class="anchor" href="#caveat-lector" aria-hidden="true"><span class="octicon octicon-link"></span></a>Caveat Lector</h3>
      <p><code>NOTICE:</code> This calculator is presented as an aid. You, as pilot in command, are solely responsible for assuring correct data and proper loading of your aircraft prior to flight!</p>

      <h3><a id="calculator" class="anchor" href="#calculator" aria-hidden="true"><span class="octicon octicon-link"></span></a>Calculator</h3>
      <script type="text/javascript">
        jQuery(function ($) {
          $("#fuel").change(function(){
            $("#fuelload").html($("#fuel").val()*6); //6lbs is constant for 100LL fuel
          });
          $("#calc").click(function(){
            front = parseFloat($("#front").val());
            rear = parseFloat($("#rear").val());
            baga = parseFloat($("#baga").val());
            bagb = parseFloat($("#bagb").val());
            fuel = parseFloat($("#fuel").val());
            fuelburn = parseFloat($("#fuelburn").val());
            flighttime = parseFloat($("#flighttime").val());
            fuellanding = (fuel*6) - ((fuelburn * flighttime)*6);

            empty = Math.ceil(parseFloat(1472.20) * 10) / 10;
            gross = front + rear + baga + bagb + fuel*6 + empty;
            landing = front + rear + baga + bagb + fuellanding + empty;

            emptym = empty * parseFloat(38.66);
            alert(emptym);
            frontm = front * parseFloat(37);
            rearm = rear * parseFloat(73);
            bagam = baga * parseFloat(95);
            bagbm = bagb * parseFloat(123);
            fuelm = (fuel*6) * parseFloat(48);
            fuellandm = fuellanding * parseFloat(48);
            totalm = frontm + rearm + bagam + bagbm + fuelm + emptym;
            totalmlanding = frontm + rearm + bagam + bagbm + fuellandm + emptym;

            loadcg = Math.round((totalm / gross)*100)/100;
            loadcglanding = Math.round((totalmlanding / landing)*100)/100;

            $("#calccg").html('<center>'+loadcg+'</center>');
            $("#calccglanding").html('<center>'+loadcglanding+'</center>');

            $("#calcgross").html('<center>'+gross+'</center>');

            $("#calclanding").html('<center>'+landing+'</center>');

            if (gross <= 2400){
              $("#calcgross").css("background-color","green");
              $("#calcgross").css("color","white");
              $("#calcgross").css("font-size","16px");
              $("#calcgross").css("font-weight","bold");
            }else{
              diff = gross - 2400;
              rem = Math.ceil(diff / 6);
              alert('OVER MAX TAKE OFF WEIGHT \n\nTry removing '+rem+' gallons of gasoline or '+diff+' lbs of load')
              $("#calcgross").css("background-color","red");
              $("#calcgross").css("color","white");
              $("#calcgross").css("font-size","16px");
              $("#calcgross").css("font-weight","bold");
            }

            if (landing <= 2400){
              $("#calclanding").css("background-color","green");
              $("#calclanding").css("color","white");
              $("#calclanding").css("font-size","16px");
              $("#calclanding").css("font-weight","bold");
            }else{
              diff1 = landing - 2400;
              rem = Math.ceil(diff1 / 6);
              alert('OVER MAX LANDING WEIGHT \n\nTry removing '+rem+' gallons of gasoline or '+diff1+' lbs of load');
              $("#calclanding").css("background-color","red");
              $("#calclanding").css("color","white");
              $("#calclanding").css("font-size","16px");
              $("#calclanding").css("font-weight","bold");
            }

            $("#calcva").html('<center>'+Math.round(105 * (Math.sqrt(gross / 2400)))+' kts @ '+gross+' lbs</center>'); //<!-- todo -->
            $("#calcvaland").html('<center>'+Math.round(105 * (Math.sqrt(landing / 2400)))+' kts @ '+landing+' lbs</center>'); //<!-- todo -->

            $('#chart-div').highcharts({
                    chart: {
                        type: 'line'
                    },
                  title: {
                      text: 'Center Of Gravity Envelope'
                  },
                  xAxis: {
                      categories: ['CG (inches)'],
                      title: {
                        text: 'CG (inches)'
                      },
                  },
                  yAxis: {
                      title: {
                        text: 'Weight (lbs)'
                      },
                      min: 1500
                  },
                  plotOptions: {
                      series: {
                          marker: {
                              enabled: true
                          }
                      }
                  },
                  series: [{
                    type: 'line',
                      name: 'Takeoff CG',
                      data: [[loadcg,gross]],
                      marker: {
                            radius: 8
                        }

                    },{
                    type: 'line',
                      name: 'CG Envelope',
                      data: [[35,1500],[35,1950],[39.5,2400],[47.3,2400],[47.3,1500]]
                    },{
                    type: 'line',
                      name: 'Landing CG',
                      data: [[loadcglanding,landing]],
                      marker: {
                            radius: 6
                        }

                    }
                    ]
              });
            });
          });
      </script>

      <center><h4><b>Cessna 172N</b><br /><b>N738VJ</b></h4></center>
      <table style="width:75%;margin:0 auto;">
      <tr><td colspan="2">Updated: 10/25/2015</td><td><b>Weight (lbs)</b></td><td><b>Arm (inches)</b></td></tr>
      <tr><td colspan="2"><b>Empty Weight</b></td><td>1472.20</td><td>38.66</td></tr>
      <tr><td colspan="2"><b>Front Seats</b></td><td style="background-color:#faf8cb"><input type="number" id="front" name="frontseats" max="999" value="0" style="max-width: 50px"></td><td>37</td></tr>
      <tr><td colspan="2"><b>Rear Seats</b></td><td style="background-color:#faf8cb"><input type="number" id="rear" name="rearseats" max="999" value="0" style="max-width: 50px"></td><td>73</td></tr>
      <tr><td colspan="2"><b>Baggage A</b></td><td style="background-color:#faf8cb"><input type="number" id="baga" name="bagaseats" max="999" value="0" style="max-width: 50px"></td><td>95</td></tr>
      <tr><td colspan="2"><b>Baggage B</b></td><td style="background-color:#faf8cb"><input type="number" id="bagb" name="bagbseats" max="999" value="0" style="max-width: 50px"></td><td>123</td></tr>
      <tr><td><b>Fuel Usable</b><br>(40 gal max)</td><td style="background-color:#faf8cb"><input type="number" name="fuel" id="fuel" max="40" value="40" style="max-width: 50px">gal</td><td><div id="fuelload">240</div></td><td>48</td></tr>
      <tr><td colspan="2"><b>Fuel Consumption</b></td><td style="background-color:#faf8cb"><b>Flight Time</b><br><input type="number" id="flighttime" name="flighttime" max="999" value="0" style="max-width: 50px">hrs</td><td style="background-color:#faf8cb"><b>Fuel Burn</b><br><input type="number" id="fuelburn" style="max-width: 50px" name="fuelburn" max="999" value="0">gph</td></tr>
      <tr><td colspan="4"><center><button class="styled-button" id="calc">Calculate</button><center></td></tr>
      </table>
      <center><b><h4>Results</h4></b></center>
      <table style="width:75%;margin:0 auto;">
      <tr><td></td><td><center><b>Takeoff</b></center></td><td><center><b>Landing</b></center></td></tr>
      <tr><td><b>Gross Weight</b><br>(2400 lbs max takeoff)</td><td id="calcgross"></td><td id="calclanding"></td><tr>
      <tr><td><b>Center of Gravity (inches)</b></td><td id="calccg"></td><td id="calccglanding"></td><tr>
          <tr><td><b>Maneuvering Speed</b><br>(97 kts @ 2400 lbs)</td><td id="calcva"></td><td id="calcvaland"></td><tr> <!-- todo -->
      </table>
      <br /><div id="chart-div" style="width:600px; height:400px;margin:0 auto;"></div>
      <script src="http://code.highcharts.com/highcharts.js"></script>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/VerTiGoEtrex/AACalc">AA-Calc</a> is maintained by <a href="https://github.com/VerTiGoEtrex">Noah Crocker (github/VerTiGoEtrex)</a>.</span>

        <span class="site-footer-credits">Please contact me through ScheduleMaster if you notice anything has gone out of date.</span>
      </footer>

    </section>

    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-65892240-2");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>

  </body>
</html>
